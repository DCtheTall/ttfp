Exercise 4.2a
Ø |- ((* -> *) -> *):□
----------------------
(a) *:□    (sort)
    --------------
(b) (* -> *):□    (form) on (a) and (a)
    ------------------------------------
(c) *:□    (sort)
    --------------
(d) ((* -> *) -> *):□    (form) on (b) and (c)
    -------------------------------------------
Exercise 4.2b
α:*, β:* |- ((α -> β) -> α)
---------------------------
(a) *:□    (sort)
    --------------
    |------
    | α:* |
    |------
(b) | α    (var) on (a)
    |------------------
    | |------
    | | β:* |
    | |------
(c) | | β    (var) on (a)
    | |------------------
(d) | | *:□    (weak) on (a) and (a)
    | |-----------------------------
(e) | | α    (weak) on (b) and (d)
    | |---------------------------
(f) | | *:□    (weak) on (a) and (a)
    | |-----------------------------
(g) | | β    (weak) on (c) and (f)
    | |---------------------------
(h) | | (α -> β)    (form) on (e) and (g)
    | |----------------------------------
(i) | | α    (weak) on (b) and (d)
    | |---------------------------
(j) | | ((α -> β) -> α)    (form) on (h) and (i)
    | |-----------------------------------------

Exercise 4.3a
α:*, β:*, x:α, y:(α -> β) |- (y x):β
------------------------------------
(a) *:□    (sort)
    --------------
(b) *:□    (sort)
    --------------
    |------
    | α:* |
    |------
(c) | α    (var) on (b)
    |------------------
    | |------
    | | β:* |
    | |------
(d) | | β    (var) on (b)
    | |------------------
(e) | | *:□    (weak) on (b) and (b)
    | |-----------------------------
(f) | | α    (weak) on (c) and (e)
    | |---------------------------
(g) | | *:□    (weak) on (b) and (b)
    | |-----------------------------
(h) | | β    (weak) on (d) and (g)
    | |---------------------------
(i) | | (α -> β)    (form) on (f) and (h)
    | |----------------------------------
    | | |-------------
    | | | y:(α -> β) |
    | | |-------------
(j) | | | y    (var) on (i)
    | | |------------------
(k) | | | *:□    (sort)
    | | |--------------
    | | | |------
    | | | | α:* |
    | | | |------
(l) | | | | α    (var) on (k)
    | | | |------------------
    | | | | |------
    | | | | | x:α |
    | | | | |------
(m) | | | | | x    (var) on (l)
    | | | | |------------------
(n) | | | | | α    (weak) on (c) and (e)
    | | | | |---------------------------
(o) | | | | | α    (weak) on (n) and (i)
    | | | | |---------------------------
(p) | | | | | y    (weak) on (j) and (o)
    | | | | |---------------------------
(q) | | | | | *:□    (weak) on (a) and (a)
    | | | | |-----------------------------
(r) | | | | | *:□    (weak) on (q) and (c)
    | | | | |-----------------------------
(s) | | | | | x    (weak) on (m) and (r)
    | | | | |---------------------------
(t) | | | | | α    (weak) on (c) and (e)
    | | | | |---------------------------
(u) | | | | | (α -> β)    (weak) on (i) and (t)
    | | | | |----------------------------------
(v) | | | | | x    (weak) on (s) and (u)
    | | | | |---------------------------
(w) | | | | | (y x):β    (appl) on (p) and (v)
    | | | | |---------------------------------

Exercise 4.3b
α:*, β:*, x:α, y:(α -> β), z:(β -> α) |- (z (y x)):α
----------------------------------------------------
    |------
(a) | β:* |
    |------
    | |------
(b) | | α:* |
    | |------
(c) | | (β -> α)    (form) on (a) and (b)
    | |----------------------------------
    | | |-------------
(d) | | | z:(β -> α) |
    | | |-------------
    | | | |------
(e) | | | | α:* |
    | | | |------
    | | | | |------
(f) | | | | | β:* |
    | | | | |------
(g) | | | | | (α -> β)    (form) on (e) and (f)
    | | | | |----------------------------------
    | | | | | |-------------
(h) | | | | | | y:(α -> β) |
    | | | | | |-------------
    | | | | | | |------
(i) | | | | | | | α:* |
    | | | | | | |------
    | | | | | | | |------
(j) | | | | | | | | x:α |
    | | | | | | | |------
(k) | | | | | | | | (y x):β    (appl) on (h) and (j)
    | | | | | | | |---------------------------------
(l) | | | | | | | | (z (y x)):α    (appl) on (d) and (k)
    | | | | | | | |-------------------------------------

Exercise 4.4a
α:*, β:(* -> *) |- (β (β α)):*
------------------------------
    |-------------
(a) | β:(* -> *) |
    |-------------
    | |------
(b) | | α:* |
    | |------
(c) | | (β α):*    (appl) on (a) and (b)
    | |---------------------------------
(d) | | (β (β α)):*    (appl) on (a) and (c)
    | |-------------------------------------
Exercise 4.4b
α:*, β:(* -> *), x:(β (β α)) |- (λy:α.x):(α -> (β (β α)))
---------------------------------------------------------
    |------
(a) | α:* |
    |------
    | |-------------
(b) | | β:(* -> *) |
    | |-------------
(c) | | (β α):*    (appl) on (b) and (a)
    | |---------------------------------
(d) | | (β (β α)):*    (appl) on (b) and (c)
    | |-------------------------------------
(e) | | (α -> (β (β α)))    (form) on (a) and (d)
    | |------------------------------------------
    | | |-------------
(f) | | | β:(* -> *) |
    | | |-------------
    | | | |------
(g) | | | | α:* |
    | | | |------
(h) | | | | (β α):*    (appl) on (f) and (g)
    | | | |---------------------------------
(i) | | | | (β (β α)):*    (appl) on (f) and (h)
    | | | |-------------------------------------
    | | | | |--------------
(j) | | | | | x:(β (β α)) |
    | | | | |--------------
    | | | | | |------
(k) | | | | | | y:α |
    | | | | | |------
(l) | | | | | (λy:α.x):(α -> (β (β α)))    (abst) on (j)
    | | | | |-------------------------------------------
Exercise 4.4c
Ø |- (λα:*.λβ:(* -> *).(β (β α))):(* -> (* -> *) -> *)
------------------------------------------------------
    |------
(a) | α:* |
    |------
    | |-------------
(b) | | β:(* -> *) |
    | |-------------
(c) | | (β α):*    (appl) on (b) and (a)
    | |---------------------------------
(d) | | (β (β α)):*    (appl) on (b) and (c)
    | |-------------------------------------
(e) | (λβ:(* -> *).(β (β α))):((* -> *) -> *)    (abst) on (d)
    |---------------------------------------------------------
(f) (λα:*.λβ:(* -> *).(β (β α))):(* -> (* -> *) -> *)    (abst) on (e)
    -------------------------------------------------------------------
Exercise 4.4d
nat:* |- ((λα:*.λβ:(* -> *).(β (β α))) nat (λγ:*.γ)):*
------------------------------------------------------
    |------
(a) | α:* |
    |------
    | |-------------
(b) | | β:(* -> *) |
    | |-------------
(c) | | (β α):*    (appl) on (b) and (a)
    | |---------------------------------
(d) | | (β (β α)):*    (appl) on (b) and (c)
    | |-------------------------------------
(e) | (λβ:(* -> *).(β (β α))):((* -> *) -> *)    (abst) on (d)
    |---------------------------------------------------------
(f) (λα:*.λβ:(* -> *).(β (β α))):(* -> (* -> *) -> *)    (abst) on (e)
    -------------------------------------------------------------------
    |--------
(g) | nat:* |
    |--------
(h) | ((λα:*.λβ:(* -> *).(β (β α))) nat):((* -> *) -> *)    (appl) on (f) and (g)
    |----------------------------------------------------------------------------
    | |------
(i) | | γ:* |
    | |------
(j) | (λγ:*.γ):(* -> *)    (abst) on (i)
    |-----------------------------------
(k) | ((λα:*.λβ:(* -> *).(β (β α))) nat (λγ:*.γ)):*    (appl) on (h) and (j)
    |-----------------------------------------------------------------------

Exercise 4.5
α:*, x:α |- (λy:α.x):((λβ:*.(β -> β)) α):*
------------------------------------------
    |------
(a) | α:* |
    |------
(b) | (α -> α)    (form) on (a) and (a)
    |----------------------------------
    | |------
(c) | | α:* |
    | |------
    | | |------
(d) | | | x:α |
    | | |------
    | | | |------
(e) | | | | y:α |
    | | | |------
(f) | | | (λy:α.x):(α -> α)    (abst) on (d)
    | | |-----------------------------------
    | | | |------
(g) | | | | β:* |
    | | | |------
(h) | | | | (β -> β)    (form) on (g) and (g)
    | | | |----------------------------------
(i) | | | (λβ:*.(β -> β)):(* -> *)    (abst) on (h)
    | | |------------------------------------------
    | | | |------
(j) | | | | α:* |
    | | | |------
(k) | | | | ((λβ:*.(β -> β)) α):*    (appl) on (i) and (j)
    | | | |-----------------------------------------------
(l) | | | | (λy:α.x):((λβ:*.(β -> β)) α):*    (conv) on (f) and (k)
    | | | |--------------------------------------------------------
