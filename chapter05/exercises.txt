Exercise 5.2b
Derive S:* |- (S -> S -> *):□
-----------------------------
(a) *:□    (sort)
    --------------
    |------
    | S:* |
    |------
(b) | S:*    (var) on (a)
    |--------------------
    | |------
    | | x:S |
    | |------
(c) | | x:S    (var) on (b)
    | |--------------------
    | | |------
    | | | y:S |
    | | |------
(d) | | | y:S    (var) on (b)
    | | |--------------------
(e) | | | *:□    (weak) on (a) and (a)
    | | |-----------------------------
(f) | | | *:□    (weak) on (e) and (b)
    | | |-----------------------------
(g) | | (S -> *):□    (form) on (b) and (f)
    | |------------------------------------
(h) | | (S -> *):□    (weak) on (g) and (b)
    | |------------------------------------
(i) | (S -> S -> *):□    (form) on (b) and (h)
    |-----------------------------------------

Exercise 5.3
Derive (Πx:S,y:S.(Q x y)):*
---------------------------
(1) Ø |- *:□    (sort)
----------------------
(2) S:* |- S:*    (var) on (1)
------------------------------
(3) S:*, x:S |- x:S    (var) on (2)
-----------------------------------
(4) S:*, y:S |- y:S    (var) on (2)
-----------------------------------
(5) S:* |- *:□    (weak) on (1) and (1)
---------------------------------------
(6) S:*, y:S |- *:□    (weak) on (5) and (2)
--------------------------------------------
(7) S:* |- (S -> *):□    (form) on (2) and (6)
----------------------------------------------
(8) S:*, x:S |- (S -> *):□    (weak) on (7) and (2)
---------------------------------------------------
(9) S:* |- (S -> S -> *):□    (form) on (2) and (8)
---------------------------------------------------
(10) S:*, Q:(S -> S -> *) |- Q:(S -> S -> *)    (var) on (9)
------------------------------------------------------------
(11) S:*, Q:(S -> S -> *) |- S:*    (weak) on (2) and (9)
---------------------------------------------------------
(12) S:*, Q:(S -> S -> *), x:S |- x:S    (var) on (11)
------------------------------------------------------
(13) S:*, Q:(S -> S -> *), x:S |- S:*    (weak) on (11) and (11)
----------------------------------------------------------------
(14) S:*, Q:(S -> S -> *), x:S, y:S |- y:S    (var) on (13)
-----------------------------------------------------------
(15) S:*, Q:(S -> S -> *), x:S |- Q:(S -> S -> *)    (weak) on (10) and (11)
----------------------------------------------------------------------------
(16) S:*, Q:(S -> S -> *), x:S, y:S |- Q:(S -> S -> *)    (weak) on (15) and (13)
---------------------------------------------------------------------------------
(17) S:*, x:S |- (S -> S -> *):□    (weak) on (9) and (2)
---------------------------------------------------------
(18) S:*, x:S, Q:(S -> S -> *) |- x:S    (weak) on (3) and (17)
---------------------------------------------------------------
(19) S:*, Q:(S -> S -> *), x:S, y:S |- x:S    (weak) on (18) and (13)
---------------------------------------------------------------------
(20) S:*, Q:(S -> S -> *), x:S, y:S |- (Q x):(S -> *)    (appl) on (16) and (19)
--------------------------------------------------------------------------------
(21) S:*, y:S |- (S -> S -> *):□    (weak) on (9) and (2)
---------------------------------------------------------
(22) S:*, y:S, Q:(S -> S -> *) |- y:S    (weak) on (4) and (21)
---------------------------------------------------------------
(23) S:*, Q:(S -> S -> *), y:S |- S:*    (weak) on (11) and (11)
----------------------------------------------------------------
(24) S:*, Q:(S -> S -> *), y:S, x:S |- y:S    (weak) on (22) and (23)
---------------------------------------------------------------------
(25) S:*, Q:(S -> S -> *), x:S, y:S |- (Q x y):*    (appl) on (20) and (24)
---------------------------------------------------------------------------
(26) S:*, Q:(S -> S -> *), x:S |- (Πy:S.(Q x y)):*    (form) on (13) and (25)
-----------------------------------------------------------------------------
(27) S:*, Q:(S -> S -> *) |- (Πx:S,y:S.(Q x y)):*    (form) on (11) and (26)
----------------------------------------------------------------------------

Exercise 5.5
Prove (A => ((A => B) => B)) is a tautology
Find an inhabitant of (A -> (A -> B) -> B):*
Derive (λu:A.λv:(A -> B).(v u):B):(A -> (A -> B) -> B)
------------------------------------------------------
    |------
(a) | A:* |
    |------
    | |------
(b) | | B:* |
    | |------
    | | |------
(c) | | | u:A |
    | | |------
    | | | |-------------
(e) | | | | v:(A -> B) |
    | | | |-------------
(f) | | | | (v u):B    (appl) on (d) and (c)
    | | | |---------------------------------
(g) | | | (λv:(A -> B).(v u):B):((A -> B) -> B)    (abst) on (f)
    | | |-------------------------------------------------------
(h) | | (λu:A.λv:(A -> B).(v u):B):(A -> (A -> B) -> B)    (abst) on (g)
    | |-----------------------------------------------------------------

Exercise 5.6
Prove ((A => (A => B)) => (A => B)) is a tautology
Find an inhabitant of ((A -> A -> B) -> A -> B):*
Derive (λv:(A -> A -> B).λu:A.(v u u):B):((A -> A -> B) -> A -> B)
------------------------------------------------------------------
    |------
(a) | A:* |
    |------
    | |------
(b) | | B:* |
    | |------
    | | |------------------
(c) | | | v:(A -> A -> B) |
    | | |------------------
    | | | |------
(d) | | | | u:A |
    | | | |------
(e) | | | | (v u):(A -> B)    (appl) on (c) and (d)
    | | | |----------------------------------------
(f) | | | | (v u u):B    (appl) on (e) and (d)
    | | | |-----------------------------------
(g) | | | (λu:A.(v u u):B):(A -> B)    (abst) on (f)
    | | |-------------------------------------------
(h) | | (λv:(A -> A -> B).λu:A.(v u u):B):((A -> A -> B) -> A -> B)    (abst) on (g)
    | |-----------------------------------------------------------------------------

Exericse 5.7a
Prove ((A => B) => ((B => C) => (A => C))) is a tautology
Find an inhabitant of ((A -> C) -> (B -> C) -> A -> C):*
Derive (λu:(A -> B).λv:(B -> C).λw:A.(v (u w)):C):((A -> B) -> (B -> C) -> A -> C)
----------------------------------------------------------------------------------
    |------
(a) | A:* |
    |------
    | |------
(b) | | C:* |
    | |------
    | | |------
(c) | | | B:* |
    | | |------
    | | | |-------------
(d) | | | | u:(A -> B) |
    | | | |-------------
    | | | | |-------------
(i) | | | | | v:(B -> C) |
    | | | | |-------------
    | | | | | |------
(j) | | | | | | w:A |
    | | | | | |------
(k) | | | | | | (u w):B    (appl) on (d) and (h)
    | | | | | |---------------------------------
(l) | | | | | | (v (u w)):C    (appl) on (g) and (k)
    | | | | | |-------------------------------------
(m) | | | | | (λw:A.(v (u w)):C):(A -> C)    (abst) on (l)
    | | | | |---------------------------------------------
(n) | | | | (λv:(B -> C).λw:A.(v (u w)):C):((B -> C) -> A -> C)    (abst) on (m)
    | | | |---------------------------------------------------------------------
(o) | | | (λu:(A -> B).λv:(B -> C).λw:A.(v (u w)):C):((A -> B) -> (B -> C) -> A -> C)    (abst) on (n)
    | | |---------------------------------------------------------------------------------------------
Exercise 5.7b
Prove (((A => B) => A) => ((A => B) => B)) is a tautology
Find an inhabitant of (((A -> B) -> A) -> (A -> B) -> B):*
Derive (λu:((A -> B) -> A).λv:(A -> B).(v (u v)):B):(((A -> B) -> A) -> (A -> B) -> B)
--------------------------------------------------------------------------------------
    |------
(a) | A:* |
    |------
    | |------
(b) | | B:* |
    | |------
    | | |--------------------
(c) | | | u:((A -> B) -> A) |
    | | |--------------------
    | | | |-------------
(e) | | | | v:(A -> B) |
    | | | |-------------
(f) | | | | (u v):A    (appl) on (c) and (d)
    | | | |---------------------------------
(g) | | | | (v (u v)):B    (appl) on (d) and (f)
    | | | |-------------------------------------
(h) | | | (λv:(A -> B).(v (u v)):B):((A -> B) -> B)    (abst) on (g)
    | | |-----------------------------------------------------------
(i) | | (λu:((A -> B) -> A).λv:(A -> B).(v (u v)):B):(((A -> B) -> A) -> (A -> B) -> B)    (abst) on (h)
    | |-------------------------------------------------------------------------------------------------
Exercise 5.7c
Prove ((A => (B => C)) => ((A => B) => (A => C))) is a tautology
Find an inhabitant of ((A -> B -> C) -> (A -> B) -> A -> C):*
Derive (λu:(A -> B -> C).λv:(A -> B).λw:A.(u w (v w)):C):((A -> B -> C) -> (A -> B) -> A -> C)
----------------------------------------------------------------------------------------------
    |------
(a) | A:* |
    |------
    | |------
(b) | | B:* |
    | |------
    | | |------
(c) | | | C:* |
    | | |------
    | | | |------------------
(h) | | | | u:(A -> B -> C) |
    | | | |------------------
    | | | | |-------------
(k) | | | | | v:(A -> B) |
    | | | | |-------------
    | | | | | |------
(l) | | | | | | w:A |
    | | | | | |------
(m) | | | | | | (u w):(B -> C)    (appl) on (h) and (j)
    | | | | | |----------------------------------------
(n) | | | | | | (v w):B    (appl) on (i) and (j)
    | | | | | |---------------------------------
(o) | | | | | | (u w (v w)):C    (appl) on (m) and (n)
    | | | | | |---------------------------------------
(p) | | | | | (λw:A.(u w (v w)):C):(A -> C)    (abst) on (o)
    | | | | |-----------------------------------------------
(q) | | | | (λv:(A -> B).λw:A.(u w (v w)):C):((A -> B) -> A -> C)    (abst) on (p)
    | | | |-----------------------------------------------------------------------
(r) | | | (λu:(A -> B -> C).λv:(A -> B).λw:A.(u w (v w)):C):((A -> B -> C) -> (A -> B) -> A -> C)    (abst) on (q)
    | | |---------------------------------------------------------------------------------------------------------

Exercise 5.8a
Find an inhabitant of (Πx:S.((P x) -> (Q x) -> (P x))):*
Derive (λx:S.λp:(P x).λq:(Q x).p):(Πx:S.((P x) -> (Q x) -> (P x)))
------------------------------------------------------------------
    |------
(a) | S:* |
    |------
    | |-------------
(c) | | P:(S -> *) |
    | |-------------
    | | |-------------
(e) | | | Q:(S -> *) |
    | | |-------------
    | | | |------
(f) | | | | x:S |
    | | | |------
    | | | | |----------
(g) | | | | | p:(P x) |
    | | | | |----------
    | | | | | |----------
(k) | | | | | | q:(Q x) |
    | | | | | |----------
(l) | | | | | (λq:(Q x).p):((Q x) -> (P x))    (abst) on (g)
    | | | | |-----------------------------------------------
(m) | | | | (λp:(P x).λq:(Q x).p):((P x) -> (Q x) -> (P x))    (abst) on (l)
    | | | |-----------------------------------------------------------------
(n) | | | (λx:S.λp:(P x).λq:(Q x).p):(Πx:S.((P x) -> (Q x) -> (P x)))    (abst) on (m)
    | | |-----------------------------------------------------------------------------

Exercise 5.9a
Prove: ∀x ∈ S: Q(x) => ∀y ∈ S: (P(y) => Q(y))
Find an inhabitant of ((Πx:S.(Q x)) -> (Πy:S.((P y) -> (Q y)))):*
Derive (λu:(Πx:S.(Q x)).λy:S.λv:(P y).(u y):(Q y)):((Πx:S.(Q x)) -> (Πy:S.((P y) -> (Q y))))
--------------------------------------------------------------------------------------------
    |------
(a) | S:* |
    |------
    | |-------------
(b) | | P:(S -> *) |
    | |-------------
    | | |-------------
(c) | | | Q:(S -> *) |
    | | |-------------
    | | | |-----------------
(e) | | | | u:(Πx:S.(Q x)) |
    | | | |-----------------
    | | | | |------
(k) | | | | | y:S |
    | | | | |------
    | | | | | |----------
(l) | | | | | | v:(P y) |
    | | | | | |----------
(m) | | | | | | (u y):(Q y)    (appl) on (e) and (f)
    | | | | | |-------------------------------------
(n) | | | | | (λv:(P y).(u y):(Q y)):((P y) -> (Q y))    (abst) on (m)
    | | | | |---------------------------------------------------------
(o) | | | | (λy:S.λv:(P y).(u y):(Q y)):(Πy:S.((P y) -> (Q y)))    (abst) on (n)
    | | | |---------------------------------------------------------------------
(p) | | | (λu:(Πx:S.(Q x)).λy:S.λv:(P y).(u y):(Q y)):((Πx:S.(Q x)) -> (Πy:S.((P y) -> (Q y))))    (abst) on (o)
    | | |-------------------------------------------------------------------------------------------------------
Exercise 5.9b
Prove: (∀x ∈ S: (P(x) => Q(x))) => (∀y ∈ S: P(y)) => (∀z ∈ S: Q(z))
Find an inhabitant of ((Πx:S.((P x) -> (Q x))) -> (Πy:S.(P y)) -> (Πz:S.(Q z))):*
Derive (λu:(Πx:S.((P x) -> (Q x))).λv:(Πy:S.(P y)).λz:S.(u z (v z)):(Q z)):((Πx:S.((P x) -> (Q x))) -> (Πy:S.(P y)) -> (Πz:S.(Q z)))
------------------------------------------------------------------------------------------------------------------------------------
    |------
(a) | S:* |
    |------
    | |-------------
(b) | | P:(S -> *) |
    | |-------------
    | | |-------------
(c) | | | Q:(S -> *) |
    | | |-------------
    | | | |----------------------------
(e) | | | | u:(Πx:S.((P x) -> (Q x))) |
    | | | |----------------------------
    | | | | |-----------------
(i) | | | | | v:(Πy:S.(P y)) |
    | | | | |-----------------
    | | | | | |------
(j) | | | | | | z:S |
    | | | | | |------
(k) | | | | | | (u z):((P z) -> (Q z))    (appl) on (e) and (g)
    | | | | | |------------------------------------------------
(l) | | | | | | (v z):(P z)    (appl) on (f) and (g)
    | | | | | |-------------------------------------
(m) | | | | | | (u z (v z)):(Q z)    (appl) on (k) and (l)
    | | | | | |-------------------------------------------
(n) | | | | | (λz:S.(u z (v z)):(Q z)):(Πz:S.(Q z))    (abst) on (m)
    | | | | |-------------------------------------------------------
(o) | | | | (λv:(Πy:S.(P y)).λz:S.(u z (v z)):(Q z)):((Πy:S.(P y)) -> (Πz:S.(Q z)))    (abst) on (n)
    | | | |-----------------------------------------------------------------------------------------
(p) | | | (λu:(Πx:S.((P x) -> (Q x))).λv:(Πy:S.(P y)).λz:S.(u z (v z)):(Q z)):((Πx:S.((P x) -> (Q x))) -> (Πy:S.(P y)) -> (Πz:S.(Q z)))    (abst) on (o)
    | | |-----------------------------------------------------------------------------------------------------------------------------------------------
